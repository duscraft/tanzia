{{define "content"}}
<main class="flex-grow flex flex-col items-center justify-center py-20 px-6 sm:px-12 text-center max-w-7xl mx-auto">
  <div class="w-full max-w-md bg-surface p-8 sm:p-10 rounded-3xl shadow-xl border border-border">
    <div class="mb-8">
      <h2 class="text-3xl font-extrabold text-textMain tracking-tight mb-2">Mise à jour requise</h2>
      <p class="text-textMuted">Pour des raisons de sécurité, veuillez définir un nouveau mot de passe.</p>
    </div>
    
    <div id="reset-error" class="hidden bg-red-500/10 border border-red-500/20 text-red-600 dark:text-red-400 p-4 rounded-xl text-sm font-medium mb-6 text-center animate-pulse">
      <span id="error-message">Le mot de passe ne respecte pas les critères de sécurité.</span>
    </div>
    
    <div id="reset-success" class="hidden bg-green-500/10 border border-green-500/20 text-green-600 dark:text-green-400 p-4 rounded-xl text-sm font-medium mb-6 text-center">
      Mot de passe mis à jour avec succès !
    </div>
    
    <form action="/reset-password" method="POST" class="space-y-5">
      <div class="text-left">
        <label for="current_password" class="block mb-2 text-sm font-semibold text-textMain">Mot de passe actuel</label>
        <input type="password" id="current_password" name="current_password" required
          class="w-full px-4 py-3 rounded-xl bg-surfaceHighlight border border-border text-textMain placeholder-textMuted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"
          placeholder="••••••••" />
      </div>
      <div class="text-left">
        <label for="new_password" class="block mb-2 text-sm font-semibold text-textMain">Nouveau mot de passe</label>
        <input type="password" id="new_password" name="new_password" required
          class="w-full px-4 py-3 rounded-xl bg-surfaceHighlight border border-border text-textMain placeholder-textMuted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"
          placeholder="••••••••" />
        <p class="text-xs text-textMuted mt-2">8 caractères minimum, avec majuscule, minuscule et chiffre.</p>
      </div>
      <div class="text-left">
        <label for="confirm_password" class="block mb-2 text-sm font-semibold text-textMain">Confirmer le mot de passe</label>
        <input type="password" id="confirm_password" name="confirm_password" required
          class="w-full px-4 py-3 rounded-xl bg-surfaceHighlight border border-border text-textMain placeholder-textMuted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"
          placeholder="••••••••" />
      </div>
      
      <button type="submit"
        class="w-full bg-primary hover:bg-primaryHover text-white py-3.5 rounded-xl font-bold shadow-lg shadow-primary/25 transition-all hover:scale-[1.02] hover:shadow-primary/40 active:scale-[0.98]">
        Mettre à jour le mot de passe
      </button>
    </form>
  </div>
</main>
<script>
  if (window.location.hash === "#required") {
    document.getElementById("reset-error").classList.add("hidden");
  }
  if (window.location.hash === "#invalid") {
    document.getElementById("reset-error").classList.remove("hidden");
    document.getElementById("error-message").textContent = "Mot de passe actuel incorrect.";
  }
  if (window.location.hash === "#weak") {
    document.getElementById("reset-error").classList.remove("hidden");
    document.getElementById("error-message").textContent = "Le mot de passe ne respecte pas les critères de sécurité.";
  }
  if (window.location.hash === "#mismatch") {
    document.getElementById("reset-error").classList.remove("hidden");
    document.getElementById("error-message").textContent = "Les mots de passe ne correspondent pas.";
  }
  if (window.location.hash === "#success") {
    document.getElementById("reset-success").classList.remove("hidden");
    setTimeout(function() { window.location.href = "/dashboard"; }, 2000);
  }
</script>
{{end}}
